---
output:
  html_document: default
  pdf_document: default
---
## 3 Průzkumová analýza dat

```{r diagram_img, fig.align='center', fig.cap="\\label{fig9} Posloupnost datové analýzy",out.width= '100%', fig.pos='H', echo=FALSE}
knitr::include_graphics("fig/EDA_diagram2.png")
```

\qquad Úkolem průzkumové analýzy dat (*Explanatory Data Analysis*, zkráceně EDA) je vizualizace a transformace dat systematickým způsobem za účelem maximálního pochopení dat, určení vztahu mezi nimi a posouzení jejích kvality. EDA je důležitou části datové analýzy a měla by být jedním z jejích prvních kroků.

\qquad Zařazení průzkumové analýzy dat do procesu datové analýzy je zobrazeno v diagramu \ref{fig9}. Prvním krokem datové analýzy je **import** dat. Obecně v tomto případě to znamená nahrání obdržených dat ze souboru či databáze do prostředí R. Bez tohoto kroku datová analýza nemůže být vykonána. V momentě když data jsou importována do R je dobře je **očístit** neboli **přípravit**. Tím je myšleno ukládání dat v konzistentní a systematické formě, odpovídající sémantice původního datasetu. Zkratka očištěné data jsou taková data, ve kterých sloupce odpovídají proměnným a řádky odpovídají pozorováním. Taková příprava dat usnadňuje další práci s nimi. 

\qquad Jakmile data jsou očištěná je obvyklým krokem jejich transformace. **Transformaci** se rozumí omezení pozorování (například dle zájmového území, povodí), vytváření nových proměnných, na základě již existujících, agregace (např. z denního do měsíčního kroku) a výpočet souhrnných statistik (střední hodnoty, kvantily atd.), odstranění odlehlých pozorování, normalizace. Po tom co jsou data očištěná a obsahují veškeré potřebné proměnné je možné na ně aplikovat dva nejdůležitější nástroje k zjištění informaci: vizualizaci a modelování. Tyto nástroje mají svoje výhody a nevýhody a jakákoliv skutečná analýza se na ně opakovaně obrací. 

\qquad __Vizualizace__ je schopná odhalit neočekávané chování dat a poukázat na další směr analýzy. Vizualizaci lze odhalit nevhodně zvolená či špatně připravená data a nekorektní dotazování. I přesto že vizualizace je dobrým nástrojem datové analýzy, její aplikace na větší datasety je značně náročná a interpretace výsledku je na analytikovi. 

\qquad __Modelování__ je doplňek vizualizace. Jedná se o zásadně matematický a výpočetní nástroj, který se obecně hodí i na větší datasety. Téměř každý model musí splňovat své předpoklady, které by měli být ověřené před jejich aplikaci, na rozdíl od vizualizace, která žádnými předpoklady nedisponuje.[@grolemund_wickham2016] 

\qquad Důležitou součásti analýzy je **interpretace** výsledků a formulace závěrů. Vyhodnocuje se jak dobře zvolený model či vizualizace slouží k pochopení dat a jejich popisu. Je také důležitý si uvědomit komu se výsledky interpretují, kdo je cílová skupina. Dobře provedené grafické výstupy podložené jejich správnou interpretaci jsou jedním z nejlepších způsobů prezentaci dát. 

\qquad Průzkumová analýza dat není specifikována jako konkretní soubor pravidel a postupu, ale jako přístup k analýze dat. Obvykle zahrnuje následující kroky:

* vyhledávání vybočujících (odlehlých) pozorování,
* náhrada chybějících hodnot,
* transformace dat,
* změny typu proměnných,
* ověřování normality

### 3.1 Odlehlá pozorování

\qquad Odlehlá pozorování (*outliers*) jsou významně odlišná vůči ostatním hodnotám datasetu. Definice toho, jak moc odlišná taková pozorování mají být je dáno analytikem na základě konkretního datasetu a kontextu problematiky. Tato pozorování mohou být indikátorem chybných dat nebo vzácných událostí. Důvody proč se tato pozorování vyskytují by měli by být pečlivě zkoumány. Dále je důležité posoudit jak je jimi ovlivněn výsledek analýzy. Případně zdali je předpoklady metody připouštějí. 

\qquad Hledání odlehlých, vybočujících pozorování a jiných anomálií pro jednotlivé veličiny se dá udělat graficky například pomoci boxplotu (viz. sekce [2.3.2](#boxplot)), bodových grafů ([2.1](#scatterplot)) nebo číslicových histogramů ([2.4.3](#stem-and-leaf)). Dají se také vypočítat pomocí různých statistik, například metoda *jackknife*, která bude popsána v následující kapitole ([3.1.1](#jackknife)). V momentech, kdy je vizualizace obtížná (velké datasety, větší množství navzájem se ovlivňujících proměnných, atd.), využívají se nástroje vícerozměrné, například Mahalanobisovy vzdálenosti ([3.1.2](#mbdist)), *leverages* ([3.1.3](#leverages)) a další.
 
#### 3.1.1 *Jackknife* {#jackknife}

\qquad Metoda byla původně představená Johnem W. Tukey v roce 1958 v "*The Annals of Mathematical Statistic*" [@jackknife_tukey] a jedná se o speciální případ metody *bootstrap* (více o metodě B. Efron a R. Tibshirani v "*An Introduction to the Bootstrap*" [@bootstrap]).

\qquad Postup metody *jackknife* je založen na celkem jednoduché myšlence. Zjišťují se souhrnné statistiky podsouborů, které se vytvářejí postupným vypouštěním jednotlivých pozorování z původního datasetu. Pomocí porovnání souhrnných statistik původního datasetu a vytvořených podsouborů se odhadne vliv jednotlivých pozorování na původní dataset. Jedná ze souhrnných statistik, kterou lze použit je střední hodnota $\bar{x}$. Tak, pro původní dataset obsahující $n$ pozorování střední hodnota se stanoví dle vzorce $\bar{x} = \frac{1}{n} \sum \limits_{i=1}^{n} \bar{x}_i$. Střední hodnota podsouborů se vyhodnotí následovně: 
$$\bar{x}_i = \frac{1}{n-1} \sum \limits_{j=1, j \neq i}^{n} x_j, \quad \text{kde } i=1,\dots,n.$$ 
Porovnání se pak provede dle vzorce $\textit{Var}(\bar{x}) = \frac{n-1}{n} \sum \limits_{i=1}^{n}(\bar{x}_i - \bar{x})^2$, kde $\textit{Var}(\bar{x})$ je odhad rozptylu, který indikuje, jak moc jednotlivá pozorování ovlivňují dataset, tzn. přítomnost odlehlých pozorování. Metoda může být také použitá k odhadu skutečné, neovlivněné střední hodnoty datasetu.

#### 3.1.2 Mahalanobisovy vzdalenosti {#mbdist}

#### 3.1.3 Leverages {#leverages}

#### 3.1.4 OLS

### 3.2 Náhrada chybějících pozorování

### 3.3 Transformace dat

### 3.4 Změna typu proměnných

### 3.5 Ověřování normality

# Praktická část {-}

## 4 Praktická vizualizace dat

### 4.1 Prostředí R

#### 4.1.1 Balíčky

#### 4.1.2 ...

### 4.2 Balíčky pro vizualizaci dat

#### 4.2.1 ggplot2

#### 4.2.2 lattice

#### 4.2.3 rgl

### 4.3 Balíčky pro interaktivní vizualizaci dat (htmlwidgets)

#### 4.3.1 plotly

#### 4.3.2 dygraphs

#### 4.3.3 leaflet

#### 4.3.4 ggvis

### 4.4 Balíčky pro prostorová data

#### 4.4.1 ggmap

### 4.5 ...

#### 4.5.1 raster

#### 4.5.2 rasterVis

### 4.6 Balíčky pro webové aplikace

#### 4.6.1 shiny

#### 4.6.2 flexdashboard

#### 4.6.3 dashboard
